<Window x:Class="TidyPackRat.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="TidyPackRat Configuration - Sorting your files, to clean up your mess."
        Height="700" Width="950"
        WindowStartupLocation="CenterScreen"
        Background="{StaticResource BackgroundBrush}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="{StaticResource PrimaryBrush}" Padding="20,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <StackPanel Grid.Column="0">
                    <TextBlock Text="TidyPackRat Configuration"
                               FontSize="24"
                               FontWeight="Bold"
                               Foreground="White"/>
                    <TextBlock Text="Sorting your files, to clean up your mess."
                               FontSize="12"
                               Foreground="#BDC3C7"
                               Margin="0,5,0,0"/>
                </StackPanel>
                <TextBlock Grid.Column="1"
                           Text="v1.0.0"
                           FontSize="12"
                           Foreground="#BDC3C7"
                           VerticalAlignment="Center"/>
            </Grid>
        </Border>

        <!-- Main Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="20">
            <StackPanel>
                <!-- Source Folder Section -->
                <GroupBox Header="Source Folder" Margin="0,0,0,15" Padding="10">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBox x:Name="txtSourceFolder"
                                 Grid.Column="0"
                                 Padding="8"
                                 FontSize="13"
                                 Margin="0,0,10,0"/>
                        <Button x:Name="btnBrowseSource"
                                Grid.Column="1"
                                Content="Browse..."
                                Style="{StaticResource PrimaryButton}"
                                Click="BrowseSourceFolder_Click"/>
                    </Grid>
                </GroupBox>

                <!-- File Categories Section -->
                <GroupBox Header="File Categories" Margin="0,0,0,15" Padding="10">
                    <DataGrid x:Name="dgCategories"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              CanUserDeleteRows="False"
                              GridLinesVisibility="Horizontal"
                              HeadersVisibility="Column"
                              RowHeight="35"
                              SelectionMode="Single">
                        <DataGrid.Columns>
                            <DataGridCheckBoxColumn Header="Enabled" Binding="{Binding Enabled}" Width="70"/>
                            <DataGridTextColumn Header="Category" Binding="{Binding Name}" Width="120" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Extensions" Binding="{Binding ExtensionsDisplay}" Width="*" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Destination" Binding="{Binding Destination}" Width="300"/>
                            <DataGridTemplateColumn Width="80">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Button Content="Browse"
                                                Click="BrowseCategoryDestination_Click"
                                                Tag="{Binding}"
                                                Padding="5,2"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </GroupBox>

                <!-- Rules Configuration Section -->
                <GroupBox Header="Organization Rules" Margin="0,0,0,15" Padding="10">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- File Age Threshold -->
                        <TextBlock Grid.Row="0" Grid.Column="0"
                                   Text="Skip files newer than (hours):"
                                   VerticalAlignment="Center"
                                   Margin="0,0,10,10"/>
                        <TextBox x:Name="txtFileAgeThreshold"
                                 Grid.Row="0" Grid.Column="1"
                                 Padding="8"
                                 Margin="0,0,0,10"
                                 Text="24"/>

                        <!-- Duplicate Handling -->
                        <TextBlock Grid.Row="1" Grid.Column="0"
                                   Text="Duplicate file handling:"
                                   VerticalAlignment="Center"
                                   Margin="0,0,10,10"/>
                        <ComboBox x:Name="cmbDuplicateHandling"
                                  Grid.Row="1" Grid.Column="1"
                                  Padding="8"
                                  Margin="0,0,0,10">
                            <ComboBoxItem Content="Rename (add number)" IsSelected="True" Tag="rename"/>
                            <ComboBoxItem Content="Skip duplicate files" Tag="skip"/>
                        </ComboBox>

                        <!-- Exclude Patterns -->
                        <TextBlock Grid.Row="2" Grid.Column="0"
                                   Text="Exclude patterns:"
                                   VerticalAlignment="Top"
                                   Margin="0,8,10,0"/>
                        <TextBox x:Name="txtExcludePatterns"
                                 Grid.Row="2" Grid.Column="1"
                                 Padding="8"
                                 Height="60"
                                 AcceptsReturn="True"
                                 TextWrapping="Wrap"
                                 VerticalScrollBarVisibility="Auto"
                                 Text="*.tmp&#x0a;~*&#x0a;*.crdownload&#x0a;*.part"/>
                    </Grid>
                </GroupBox>

                <!-- Schedule Configuration Section -->
                <GroupBox Header="Schedule" Margin="0,0,0,15" Padding="10">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Enable Schedule -->
                        <CheckBox x:Name="chkScheduleEnabled"
                                  Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2"
                                  Content="Enable automatic scheduling"
                                  Margin="0,0,0,10"
                                  Checked="ScheduleEnabled_Changed"
                                  Unchecked="ScheduleEnabled_Changed"/>

                        <!-- Frequency -->
                        <TextBlock Grid.Row="1" Grid.Column="0"
                                   Text="Frequency:"
                                   VerticalAlignment="Center"
                                   Margin="20,0,10,10"/>
                        <ComboBox x:Name="cmbFrequency"
                                  Grid.Row="1" Grid.Column="1"
                                  Padding="8"
                                  Margin="0,0,0,10"
                                  IsEnabled="{Binding IsChecked, ElementName=chkScheduleEnabled}">
                            <ComboBoxItem Content="Daily" IsSelected="True" Tag="daily"/>
                            <ComboBoxItem Content="Weekly" Tag="weekly"/>
                            <ComboBoxItem Content="Monthly" Tag="monthly"/>
                        </ComboBox>

                        <!-- Time -->
                        <TextBlock Grid.Row="2" Grid.Column="0"
                                   Text="Run at:"
                                   VerticalAlignment="Center"
                                   Margin="20,0,10,10"/>
                        <TextBox x:Name="txtScheduleTime"
                                 Grid.Row="2" Grid.Column="1"
                                 Padding="8"
                                 Margin="0,0,0,10"
                                 Text="02:00"
                                 IsEnabled="{Binding IsChecked, ElementName=chkScheduleEnabled}"/>

                        <!-- Run on Startup -->
                        <CheckBox x:Name="chkRunOnStartup"
                                  Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2"
                                  Content="Run when I log in"
                                  Margin="20,0,0,0"
                                  IsEnabled="{Binding IsChecked, ElementName=chkScheduleEnabled}"/>
                    </Grid>
                </GroupBox>
            </StackPanel>
        </ScrollViewer>

        <!-- Footer / Action Buttons -->
        <Border Grid.Row="2"
                Background="White"
                BorderBrush="#BDC3C7"
                BorderThickness="0,1,0,0"
                Padding="20,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <Button x:Name="btnTestRun"
                            Content="Test Run (Dry Run)"
                            Style="{StaticResource PrimaryButton}"
                            Margin="0,0,10,0"
                            Click="TestRun_Click"/>
                    <Button x:Name="btnRunNow"
                            Content="Run Now"
                            Style="{StaticResource SuccessButton}"
                            Margin="0,0,10,0"
                            Click="RunNow_Click"/>
                </StackPanel>

                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <Button x:Name="btnViewLog"
                            Content="View Log"
                            Style="{StaticResource PrimaryButton}"
                            Margin="0,0,10,0"
                            Click="ViewLog_Click"/>
                    <Button x:Name="btnSave"
                            Content="Save Configuration"
                            Style="{StaticResource SuccessButton}"
                            Click="SaveConfiguration_Click"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
